---
import { Image } from "astro:assets";

const { image, side = "left" } = Astro.props;

if (!image) {
  throw new Error("RitualBlock requires an image.");
}

const sideClass = side === "right" ? "block--right" : "block--left";
---

<div class={`ritual-block ${sideClass}`}>
  <div class="block-media">
    <Image
      src={image}
      alt=""
      loading="lazy"
      sizes="(max-width: 900px) 100vw, 50vw"
    />
  </div>

  <div class="block-content">
    <slot />
  </div>
</div>

<style>
  /* ============================= */
  /* LAYOUT */
  /* ============================= */

  .ritual-block {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-7);
    align-items: start;
    margin-bottom: var(--space-7);
  }

  /* Alternance */
  .block--right {
    direction: rtl;
  }

  .block--right .block-content,
  .block--right .block-media {
    direction: ltr;
  }

  /* ============================= */
  /* IMAGE */
  /* ============================= */

  .block-media img {
    width: 100%;
    height: auto;
    display: block;
  }

  /* ============================= */
  /* TEXTE */
  /* ============================= */

  .block-content {
    max-width: 52ch;
  }

  /* Le texte est déjà défini globalement via p {} */
  .block-content p {
    margin-bottom: var(--space-3);
  }

  .block-content p:last-child {
    margin-bottom: 0;
  }

  /* ============================= */
  /* MOBILE */
  /* ============================= */

  @media (max-width: 900px) {
    .ritual-block {
      grid-template-columns: 1fr;
      gap: var(--space-5);
      margin-bottom: var(--space-6);
    }

    .block--right {
      direction: ltr;
    }

    .block-content {
      max-width: 100%;
    }
  }
</style>
