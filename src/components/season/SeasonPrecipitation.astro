---
import SeasonBlock from "./SeasonBlock.astro";

const { id } = Astro.props;

const rows = [
  { year: "2021", vacR: 68,  flicR: 32 },
  { year: "2022", vacR: 74,  flicR: 28 },
  { year: "2023", vacR: 81,  flicR: 36 },
  { year: "2024", vacR: 92,  flicR: 41 },
  { year: "2025", vacR: 77,  flicR: 33 },
];

const avg = { vacR: 78, flicR: 34 };

const refRows = [
  { ville: "Lille",       vacR: "75–85", vacMois: "octobre",    flicR: "30–40", flicMois: "mars"     },
  { ville: "Paris",       vacR: "60–70", vacMois: "septembre",  flicR: "30–40", flicMois: "février"  },
  { ville: "Lyon",        vacR: "75–85", vacMois: "mai",        flicR: "30–40", flicMois: "juillet"  },
  { ville: "La Rochelle", vacR: "70–80", vacMois: "novembre",   flicR: "30–40", flicMois: "juillet"  },
];
---

<SeasonBlock id={id} title="Précipitations">

  <div class="meteo-wrapper">

    <div class="meteo-scroll">
      <table class="meteo-table">
        <thead>
          <tr>
            <th class="col-year"></th>
            <th class="col-group">
              <span class="col-group-name">Vacoas (mm)</span>
              <span class="col-group-sub">Plateau central</span>
            </th>
            <th class="col-group">
              <span class="col-group-name">Flic-en-Flac (mm)</span>
              <span class="col-group-sub">Côte ouest</span>
            </th>
          </tr>
        </thead>
        <tbody>
          {rows.map(r => (
            <tr>
              <td class="td-year">{r.year}</td>
              <td class="td-rain">{r.vacR}</td>
              <td class="td-rain">{r.flicR}</td>
            </tr>
          ))}
          <tr class="avg-row">
            <td class="td-year">Moy.</td>
            <td class="td-rain">{avg.vacR}</td>
            <td class="td-rain">{avg.flicR}</td>
          </tr>
          <tr class="ref-sep">
            <td colspan="3" class="ref-sep-label">Équivalents en France métropolitaine</td>
          </tr>
          {refRows.map(r => (
            <tr class="ref-row">
              <td class="td-city">{r.ville}</td>
              <td class="td-rain">{r.vacR} <span class="td-period">({r.vacMois})</span></td>
              <td class="td-rain">{r.flicR} <span class="td-period">({r.flicMois})</span></td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>

    <div class="meteo-analysis">
      <p>Pour un séjour à Maurice entre août et mi-septembre, les conditions de pluie varient sensiblement selon la région.</p>
      <p>Le plateau central (Vacoas et environs) présente un climat comparable à un mois humide d'Europe tempérée : averses possibles, nuages fréquents et atmosphère plus verte. Les pluies y sont toutefois généralement brèves et rarement continues, mais peuvent réduire l'ensoleillement.</p>
      <p>La côte ouest (Flic-en-Flac) offre au contraire des conditions proches d'un été sec européen : faibles cumuls de pluie, ciel plus dégagé et ensoleillement élevé. C'est la zone la plus favorable pour les activités balnéaires durant l'hiver austral, avec une probabilité de pluie faible.</p>
      <p>En pratique, les voyageurs recherchant le soleil et la plage privilégieront la côte ouest, tandis que ceux intéressés par la nature luxuriante et les paysages du centre de l'île accepteront un risque de pluie plus élevé. La saison reste globalement propice au tourisme sur toute l'île, avec l'avantage d'une côte ouest particulièrement sèche et lumineuse.</p>
    </div>

  </div>

</SeasonBlock>

<style>
  .meteo-wrapper {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    height: 100%;
    box-sizing: border-box;
  }

  /* Analysis */

  .meteo-analysis {
    flex: 1;
    min-height: 0;
    overflow-y: auto;
    scrollbar-width: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .meteo-analysis::-webkit-scrollbar {
    display: none;
  }

  .meteo-analysis p {
    margin: 0;
    font-size: var(--fs-body);
    line-height: var(--lh-normal);
    color: var(--color-text);
  }

  .meteo-analysis ul {
    margin: 0;
    padding-left: 1.4em;
    display: flex;
    flex-direction: column;
    gap: 0.25em;
  }

  .meteo-analysis li {
    font-size: var(--fs-body);
    line-height: var(--lh-normal);
    color: var(--color-text);
  }

  /* Table wrapper */

  .meteo-scroll {
    flex-shrink: 0;
    overflow: visible;
    border-radius: clamp(10px, 1.5vw, 16px);
    border: 1px solid #e0dbd4;
  }

  /* Table */

  .meteo-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--fs-small);
    line-height: var(--lh-tight);
    background: var(--color-page);
  }

  /* Group headers */

  thead tr:first-child th {
    padding: var(--space-1) var(--space-2);
    font-family: var(--font-display);
    font-weight: 500;
    font-size: clamp(0.75rem, 1.2vw, 0.9rem);
    letter-spacing: -0.01em;
    text-align: left;
    border-bottom: 1px solid #e0dbd4;
  }

  thead tr:first-child th.col-year {
    width: 8rem;
    border-right: 1px solid #e0dbd4;
  }

  thead tr:first-child th.col-group {
    text-align: center;
    padding-bottom: var(--space-2);
  }

  thead tr:first-child th.col-group + th.col-group {
    border-left: 1px solid #e0dbd4;
  }

  .col-group-name {
    display: block;
    font-family: var(--font-display);
    font-size: clamp(0.78rem, 1.2vw, 0.9rem);
  }

  .col-group-sub {
    display: block;
    font-family: var(--font-body);
    font-size: clamp(0.65rem, 1vw, 0.72rem);
    font-weight: 400;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: var(--color-muted);
    margin-top: 1px;
  }

  /* Body rows */

  tbody tr {
    border-bottom: 1px solid #f0ede8;
    transition: background 0.15s ease;
  }

  tbody tr:hover {
    background: rgba(181, 135, 58, 0.04);
  }

  tbody tr:last-child {
    border-bottom: none;
  }

  td {
    padding: var(--space-1) var(--space-2);
    text-align: right;
    color: var(--color-text);
    font-variant-numeric: tabular-nums;
  }

  .td-year {
    text-align: left;
    font-weight: 500;
    color: var(--color-muted);
    font-size: var(--fs-small);
    letter-spacing: 0.08em;
    border-right: 1px solid #e0dbd4;
  }

  .td-rain {
    font-weight: 500;
  }

  /* Average row */

  .avg-row {
    border-top: 2px solid #d0ccc6;
    background: rgba(181, 135, 58, 0.06);
  }

  .avg-row td {
    font-weight: 600;
    padding-top: var(--space-2);
    padding-bottom: var(--space-2);
  }

  .avg-row .td-year {
    color: #b5873a;
    font-family: var(--font-body);
    font-size: var(--fs-small);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .avg-row .td-rain {
    color: var(--color-text);
  }

  /* Reference rows */

  .ref-sep {
    border-top: 2px solid #d0ccc6;
    background: rgba(181, 135, 58, 0.03);
  }

  .ref-sep-label {
    padding: var(--space-1) var(--space-2);
    font-size: clamp(0.62rem, 0.9vw, 0.7rem);
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--color-muted);
    text-align: left;
  }

  .ref-row td {
    opacity: 0.85;
  }

  .td-city {
    text-align: left;
    font-weight: 500;
    white-space: nowrap;
    color: var(--color-text);
    border-right: 1px solid #e0dbd4;
    padding: var(--space-1) var(--space-2);
    font-size: var(--fs-small);
  }

  .td-period {
    font-size: clamp(0.62rem, 0.9vw, 0.7rem);
    font-style: italic;
    font-weight: 400;
    color: var(--color-muted);
  }
</style>
